Demonstrations of gotlskeylog.py

This tool intercepts TLS secrets from an application written in a golang and
outputs these secrets into stdout or file in a SSLKEYLOGFILE file format, which
then can be used in a Wireshark or some other tools to decrypt TLS traffic that
was generated by program that was traced. A typical usage scenario is recording
pcap file via tcpdump or some other tool, while saving secrets into a file and
then decrypting TLS traffic inside that pcap file. Usefull for sniffing traffic
that generated by program written in Golang.

Example output:

# ./gotlskeylog.py /tmp/test
CLIENT_HANDSHAKE_TRAFFIC_SECRET c7e0bad496b3b7cc515f2f46b2ee769f39f5dcfb8cf8b8be174c6a3e627bad9a fd67183aa85034e1a6c2a14e44b4cc8993300389cfaeb652d2ec6d981ad31c06c0c2da369b3922a82667f75ba7977305
SERVER_HANDSHAKE_TRAFFIC_SECRET c7e0bad496b3b7cc515f2f46b2ee769f39f5dcfb8cf8b8be174c6a3e627bad9a 0fb25a5a53610526357d1282ae8fbd7ba1dda837d5f1d5fbffd0ff1282bed043ae388a5262211a44decbb6b31ff42f6a


Tools also can be used to trace more than a single application, which is
usefull if you want to sniff traffic from more than a single golang app.

# ./gotlskeylog.py /tmp/test /tmp/anotherapp

USAGE message:

usage: gotlskeylog.py [-h] [-p PID] [-u UID] [--max-label-size MAX_LABEL_SIZE]
                      [--max-client-random-size MAX_CLIENT_RANDOM_SIZE]
                      [--max-secret-size MAX_SECRET_SIZE] [-o OUTPUT]
                      path [path ...]

Intercept TLS keys from Go app and write them in a SSLKEYLOGFILE format

positional arguments:
  path

options:
  -h, --help            show this help message and exit
  -p PID, --pid PID     Trace this PID only (default: None)
  -u UID, --uid UID     Trace this UID only (default: None)
  --max-label-size MAX_LABEL_SIZE
                        Max label size, should be in [32, 128] range (default: 32)
  --max-client-random-size MAX_CLIENT_RANDOM_SIZE
                        Max size of client_random, should be in [32, 256] (default: 32)
  --max-secret-size MAX_SECRET_SIZE
                        Max secret size, should be in [48, 256] range (default: 64)
  -o OUTPUT, --output OUTPUT

examples:
    ./gotlskeylog /path/someapp                   # trace someapp and log TLS to stdout
    ./gotlskeylog -o /tmp/tls.log /path/someapp   # trace someapp and write keys into tls.log file
    ./gotlskeylog /path/foo /path/bar             # trace TLS keys from foo and bar Go apps
    ./gotlskeylog -p 181 someapp                  # trace only PID 181 of someapp
    ./gotlskeylog -u 1000 someapp                 # trace only UID 1000
